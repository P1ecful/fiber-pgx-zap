version: "3"
tasks:
  run:
    desc: "start service"
    cmds:
      - migrate -path ./migrations -database "postgres://postgres:postgres@localhost:5432/postgres?sslmode=disable" up
      - go run cmd/server/main.go

  gen-migrations:
    desc: "generating migration files"
    cmd: migrate create -ext sql -dir ./migrations -seq song

  migrate-down:
    desc: "migrate down"
    cmd: migrate -path ./migrations -database "postgres://postgres:postgres@localhost:5432/postgres?sslmode=disable" down

  gen-mock:
    desc: "generating mocks service file"
    cmds:
      - mockgen -source=internal/service/service.go -destination=test/mocks/mock_service.go -package=mocks
      - mockgen -source=internal/storage/interface.go -destination=test/mocks/mock_storage.go -package=mocks
